import pandas as pd
from pandas_datareader import data as pdr
import yfinance as yfin
yfin.pdr_override()

nasdaq = [
'AMD',
'ADBE',
'ABNB',
'ALGN',
'AMZN',
'AMGN',
'AEP',
'ADI',
'ANSS',
'AAPL',
'AMAT',
'ASML',
'TEAM',
'ADSK',
'ATVI',
'ADP',
'AZN',
'AVGO',
'BIDU',
'BIIB',
'BMRN',
'BKNG',
'CDNS',
'CHTR',
'CPRT',
'CRWD',
'CTAS',
'CSCO',
'CMCSA',
'COST',
'CSX',
'CTSH',
'DDOG',
'DOCU',
'DXCM',
'DLTR',
'EA',
'EBAY',
'ENPH',
'EXC',
'FAST',
'META',
'FISV',
'FTNT',
'GILD',
'GOOG',
'GOOGL',
'HON',
'ILMN',
'INTC',
'INTU',
'ISRG',
'MRVL',
'IDXX',
'JD',
'KDP',
'KLAC',
'KHC',
'LRCX',
'LCID',
'LULU',
'MELI',
'MAR',
'MTCH',
'MCHP',
'MDLZ',
'MRNA',
'MNST',
'MSFT',
'MU',
'NFLX',
'NTES',
'NVDA',
'NXPI',
'ODFL',
'ORLY',
'PCAR',
'PANW',
'PAYX',
'PDD',
'PYPL',
'PEP',
'QCOM',
'REGN',
'ROST',
'SIRI',
'SGEN',
'SPLK',
'SWKS',
'SBUX',
'SNPS',
'TSLA',
'TXN',
'TMUS',
'VRSN',
'VRSK',
'VRTX',
'WBA',
'WDAY',
'XEL',
'ZM',
'ZS'
]

path = '/NASDAQ_100/'

for stock in nasdaq:
    df = pd.read_csv(f"{path}{stock}.csv", index_col='Date')
    start_date = (pd.to_datetime(df.tail(1).index.values[0]).date() + pd.to_timedelta(1, unit='d'))
    new_df = pdr.get_data_yahoo(stock, start=start_date)
    if pd.to_datetime(new_df.head(1).index.values[0]).date() >= start_date:
        df = pd.concat([df, new_df])
    df.index = pd.to_datetime(df.index, format='%Y-%m-%d')
    df.index = df.index.tz_localize(None)
    df.to_csv(f"{path}{stock}.csv")